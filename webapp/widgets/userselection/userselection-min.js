$(function(){countOfUserSelection=1;var d=true;var b;var c;$(document).delegate(".userselectionAdd","click",function(k){if(d){b=$(this).parent().find("select").eq(0).attr("textboxname");c=$(this).parent().find("select").eq(1).attr("textboxname");d=false;var m=b.split("~");if(m.length>3){b=b.substr(0,b.lastIndexOf("~"));c=c.substr(0,c.lastIndexOf("~"))}}var n=this.parentNode;var f=n.parentNode;var i=document.createElement("div");var g=(new Date()).getTime();var h="xf-handler"+g;var j=b+"~"+g;var l=c+"~"+g;i.className="xf-handler UserSelection";i.setAttribute("id",h);i.setAttribute("style","margin:10px 0px");i.innerHTML=a();i.childNodes[0].name=j;i.childNodes[0].setAttribute("id",j);i.childNodes[1].name=l;i.childNodes[1].setAttribute("id",l);f.insertBefore(i,n);countOfUserSelection++;jQuery.parser.parse("#"+h)});function a(){if(UserSelection_new_inner_html!=""){return UserSelection_new_inner_html}var e='<select class="easyui-combobox userSelectionCom" style="width:135px" name="'+this.name+"-"+xf_f_name_prefix+"us_r-@0\" data-options=\"url:'formTemplate!fetchRoles.do',method:'get',valueField:'value',textField:'name',panelHeight:'auto'\""+(this.required?"required ":"")+(this.readOnly?"disabled":"")+">";e+="</select>";e+='<input class="easyui-textbox userPicker" data-options="icons:[{iconCls:\'icon-man\',handler:showUserPickTab}]" type="text" name="'+this.name+"-"+xf_f_name_prefix+'us_u-@1" alias="'+this.alias+'" '+(this.readOnly?'readOnly="" ':"")+(this.required?"required ":"")+" reportFlag="+this.reportFlag+" >";e+='<span class="add-on" style="padding-top: 2px; padding-bottom: 2px;border-radius: 0 4px 4px 0;"><i style="cursor:pointer;" class="icon-user '+(this.readOnly?"":" userPickerBtn")+'"></i></span>';e+="<span "+(this.readOnly?"":'class="userselectionAdd"')+' style="cursor: pointer;padding: 2px;font-size: 12px;">+</span>';e+="<span "+(this.readOnly?"":'class="userselectionRemove"')+' style="cursor: pointer;padding: 2px;font-size: 12px;">-</span>';return e}$(document).delegate(".userselectionRemove","click",function(g){if(countOfUserSelection==1){$(this).focus();return false}var f=this.parentNode;var h=f.parentNode;h.removeChild(f);countOfUserSelection--})});function populatPropsFunc(i){if(!i){return false}$("#Form1").form("load",i);for(var l in i){if("object"==typeof(i[l])&&!(i[l] instanceof Array)){var j;var g;var m;if(!UserSelection_new_inner_html||!$(".UserSelection")){return false}else{m=$(".UserSelection");g=m.parent();j=$(".UserSelection").find(".easyui-combobox").attr("comboname");$(".UserSelection").html("")}countOfUserSelection=0;var a=i[l];var e=new Array();for(var l in a){var h=a[l];var k;var c;var f;var d;if(h[0].innerName.indexOf("@0")>0){k=h[0].innerName;c=h[0].value}else{k=h[1].innerName;c=h[1].value}if(h[1].innerName.indexOf("@1")>0){f=h[1].innerName;d=h[1].value}else{f=h[0].innerName;d=h[0].value}if(k.indexOf(j)!=0){$(".UserSelection").html(UserSelection_new_inner_html);break}e[k]=c;e[f]=d;var b=document.createElement("div");b.className="xf-handler UserSelection";b.setAttribute("style","margin:10px 0px");b.innerHTML=UserSelection_new_inner_html;b.childNodes[0].name=k;b.childNodes[1].name=f;b.childNodes[0].setAttribute("id",k);b.childNodes[1].setAttribute("id",f);$(".UserSelection").parent().append(b);countOfUserSelection++}jQuery.parser.parse($(".UserSelection").parent());$("#Form1").form("load",e)}}};
