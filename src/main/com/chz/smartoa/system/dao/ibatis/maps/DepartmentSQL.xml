<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- Always ensure to use the correct XML header as above! -->
<sqlMap namespace="Department">
<typeAlias alias="department" type="com.chz.smartoa.system.pojo.Department"/> 
<resultMap id="department_result" class="department">
    <result property="departmentId" column="DEPARTMENT_ID"/>
    <result property="createUser" column="CREATE_USER"/>
    <result property="departmentName" column="DEPARTMENT_NAME"/>
    <result property="email" column="EMAIL"/>
    <result property="createDate" column="CREATE_DATE"/>
    <result property="departmentDesc" column="DEPARTMENT_DESC"/>
    <result property="lastUpdateDate" column="LAST_UPDATE_DATE"/>
    <result property="parentId" column="PARENT_ID"/>
</resultMap>

<insert id="Department_insertDepartment" parameterClass="department" >
<![CDATA[
    INSERT INTO t_department (
            DEPARTMENT_ID, 
            CREATE_USER, 
            DEPARTMENT_NAME, 
            EMAIL, 
            CREATE_DATE, 
            DEPARTMENT_DESC, 
            LAST_UPDATE_DATE, 
            PARENT_ID
        )
    VALUES (
       		#departmentId#,
		       		#createUser#,
		       		#departmentName#,
		       		#email#,
		        	str_to_date(#createDate:DATE#,'%Y-%m-%d'),
		       		#departmentDesc#,
		        	str_to_date(#lastUpdateDate:DATE#,'%Y-%m-%d'),
		       		#parentId#
		    )
]]>
</insert>

<delete id="Department_deleteDepartment" parameterClass="java.lang.String">
<![CDATA[
    DELETE  FROM  t_department WHERE DEPARTMENT_ID = #departmentId#
]]>
		
</delete>    

<update id="Department_updateDepartment" parameterClass="department">
    UPDATE t_department 
    SET
    	DEPARTMENT_ID = #departmentId#
	<isNotEmpty prepend="," property="createUser">
     	   		CREATE_USER = #createUser#
				</isNotEmpty>
	<isNotEmpty prepend="," property="departmentName">
     	   		DEPARTMENT_NAME = #departmentName#
				</isNotEmpty>
	<isNotEmpty prepend="," property="email">
     	   		EMAIL = #email#
				</isNotEmpty>
	<isNotEmpty prepend="," property="createDate">
     	    	CREATE_DATE = str_to_date(#createDate:DATE#,'%Y-%m-%d')
				</isNotEmpty>
	<isNotEmpty prepend="," property="departmentDesc">
     	   		DEPARTMENT_DESC = #departmentDesc#
				</isNotEmpty>
	<isNotEmpty prepend="," property="lastUpdateDate">
     	    	LAST_UPDATE_DATE = str_to_date(#lastUpdateDate:DATE#,'%Y-%m-%d')
				</isNotEmpty>
	<isNotEmpty prepend="," property="parentId">
     	   		PARENT_ID = #parentId#
				</isNotEmpty>
    WHERE DEPARTMENT_ID = #departmentId#
</update> 

<select id="Department_findDepartment" resultMap="department_result" parameterClass="string">
<![CDATA[
    SELECT
       		DEPARTMENT_ID,
		       		CREATE_USER,
		       		DEPARTMENT_NAME,
		       		EMAIL,
		        	date_format(CREATE_DATE,'%Y-%m-%d') CREATE_DATE,
		       		DEPARTMENT_DESC,
		        	date_format(LAST_UPDATE_DATE,'%Y-%m-%d') LAST_UPDATE_DATE,
		       		PARENT_ID
		    FROM t_department WHERE DEPARTMENT_ID = #departmentId#
]]>
</select>

<select id="Department_listDepartment" resultMap="department_result" parameterClass="department">
<![CDATA[
    SELECT
       		DEPARTMENT_ID,
		       		CREATE_USER,
		       		DEPARTMENT_NAME,
		       		EMAIL,
		        	date_format(CREATE_DATE,'%Y-%m-%d') CREATE_DATE,
		       		DEPARTMENT_DESC,
		        	date_format(LAST_UPDATE_DATE,'%Y-%m-%d') LAST_UPDATE_DATE,
		       		PARENT_ID
		    FROM t_department
]]>
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="and" property = "departmentId">
				DEPARTMENT_ID = #departmentId#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "createUser">
				CREATE_USER = #createUser#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "departmentName">
				DEPARTMENT_NAME = #departmentName#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "email">
				EMAIL = #email#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "createDate">
				CREATE_DATE = #createDate#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "departmentDesc">
				DEPARTMENT_DESC = #departmentDesc#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "lastUpdateDate">
				LAST_UPDATE_DATE = #lastUpdateDate#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "parentId">
				PARENT_ID = #parentId#
			</isNotEmpty>
		</dynamic>
</select>

<select id="Department_listDepartmentPage" resultMap="department_result" parameterClass="java.lang.String">
<![CDATA[
 $sql$
]]>
</select>


<select id="Department_listDepartmentCount" resultClass="java.lang.Integer" parameterClass="department">
<![CDATA[
    SELECT
		COUNT(*)
    FROM t_department
]]>
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="and" property = "departmentId">
				DEPARTMENT_ID = #departmentId#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "createUser">
				CREATE_USER = #createUser#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "departmentName">
				DEPARTMENT_NAME = #departmentName#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "email">
				EMAIL = #email#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "createDate">
				CREATE_DATE = #createDate#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "departmentDesc">
				DEPARTMENT_DESC = #departmentDesc#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "lastUpdateDate">
				LAST_UPDATE_DATE = #lastUpdateDate#
			</isNotEmpty>
			<isNotEmpty prepend="and" property = "parentId">
				PARENT_ID = #parentId#
			</isNotEmpty>
		</dynamic>
</select>

</sqlMap>